'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var index_module$3 = require('../../react-use-controllable-state/dist/index.module.js');
var index_module$4 = require('../../react-use-callback-ref/dist/index.module.js');
var index_module$5 = require('../../react-primitive/dist/index.module.js');
var index_module$7 = require('../../react-id/dist/index.module.js');
var index_module$1 = require('../../react-context/dist/index.module.js');
var index_module$2 = require('../../react-compose-refs/dist/index.module.js');
var index_module = require('../../react-collection/dist/index.module.js');
var index_module$6 = require('../../primitive/dist/index.module.js');
var React = require('react');
var _extends = require('../../../@babel/runtime/helpers/esm/extends.js');

function _interopNamespace(e) {
	if (e && e.__esModule) return e;
	var n = Object.create(null);
	if (e) {
		Object.keys(e).forEach(function (k) {
			if (k !== 'default') {
				var d = Object.getOwnPropertyDescriptor(e, k);
				Object.defineProperty(n, k, d.get ? d : {
					enumerable: true,
					get: function () { return e[k]; }
				});
			}
		});
	}
	n["default"] = e;
	return Object.freeze(n);
}

var React__namespace = /*#__PURE__*/_interopNamespace(React);

const f={bubbles:!1,cancelable:!0},[p,l,m]=index_module.createCollection("RovingFocusGroup"),[d,v]=index_module$1.createContextScope("RovingFocusGroup",[m]);const[g,F]=d("RovingFocusGroup");const RovingFocusGroup=/*#__PURE__*/React__namespace.forwardRef(((e,o)=>/*#__PURE__*/React__namespace.createElement(p.Provider,{scope:e.__scopeRovingFocusGroup},/*#__PURE__*/React__namespace.createElement(p.Slot,{scope:e.__scopeRovingFocusGroup},/*#__PURE__*/React__namespace.createElement(w,_extends["default"]({},e,{ref:o}))))));const w=/*#__PURE__*/React__namespace.forwardRef(((t,n)=>{const{__scopeRovingFocusGroup:c,orientation:p,dir:m="ltr",loop:d=!1,currentTabStopId:v,defaultCurrentTabStopId:F,onCurrentTabStopIdChange:w,onEntryFocus:b,...x}=t,E=React__namespace.useRef(null),I=index_module$2.useComposedRefs(n,E),[G=null,h]=index_module$3.useControllableState({prop:v,defaultProp:F,onChange:w}),[T,A]=React__namespace.useState(!1),y=index_module$4.useCallbackRef(b),D=l(c),S=React__namespace.useRef(!1);return React__namespace.useEffect((()=>{const e=E.current;if(e)return e.addEventListener("rovingFocusGroup.onEntryFocus",y),()=>e.removeEventListener("rovingFocusGroup.onEntryFocus",y)}),[y]),/*#__PURE__*/React__namespace.createElement(g,{scope:c,orientation:p,dir:m,loop:d,currentTabStopId:G,onItemFocus:React__namespace.useCallback((e=>h(e)),[h]),onItemShiftTab:React__namespace.useCallback((()=>A(!0)),[])},/*#__PURE__*/React__namespace.createElement(index_module$5.Primitive.div,_extends["default"]({tabIndex:T?-1:0,"data-orientation":p},x,{ref:I,style:{outline:"none",...t.style},onMouseDown:index_module$6.composeEventHandlers(t.onMouseDown,(()=>{S.current=!0;})),onFocus:index_module$6.composeEventHandlers(t.onFocus,(e=>{const o=!S.current;if(e.target===e.currentTarget&&o&&!T){const o=new Event("rovingFocusGroup.onEntryFocus",f);if(e.currentTarget.dispatchEvent(o),!o.defaultPrevented){const e=D().filter((e=>e.focusable));R([e.find((e=>e.active)),e.find((e=>e.id===G)),...e].filter(Boolean).map((e=>e.ref.current)));}}S.current=!1;})),onBlur:index_module$6.composeEventHandlers(t.onBlur,(()=>A(!1)))})))}));const RovingFocusGroupItem=/*#__PURE__*/React__namespace.forwardRef(((e,o)=>{const{__scopeRovingFocusGroup:n,focusable:i=!0,active:c=!1,...f}=e,m=index_module$7.useId(),d=F("RovingFocusGroupItem",n),v=d.currentTabStopId===m,g=l(n);return React__namespace.createElement(p.ItemSlot,{scope:n,id:m,focusable:i,active:c},/*#__PURE__*/React__namespace.createElement(index_module$5.Primitive.span,_extends["default"]({tabIndex:v?0:-1,"data-orientation":d.orientation},f,{ref:o,onMouseDown:index_module$6.composeEventHandlers(e.onMouseDown,(e=>{i?d.onItemFocus(m):e.preventDefault();})),onFocus:index_module$6.composeEventHandlers(e.onFocus,(()=>d.onItemFocus(m))),onKeyDown:index_module$6.composeEventHandlers(e.onKeyDown,(e=>{if("Tab"===e.key&&e.shiftKey)return void d.onItemShiftTab();if(e.target!==e.currentTarget)return;const o=function(e,o,r){const t=function(e,o){return "rtl"!==o?e:"ArrowLeft"===e?"ArrowRight":"ArrowRight"===e?"ArrowLeft":e}(e.key,r);return "vertical"===o&&["ArrowLeft","ArrowRight"].includes(t)||"horizontal"===o&&["ArrowUp","ArrowDown"].includes(t)?void 0:b[t]}(e,d.orientation,d.dir);if(void 0!==o){e.preventDefault();let n=g().filter((e=>e.focusable)).map((e=>e.ref.current));if("last"===o)n.reverse();else if("prev"===o||"next"===o){"prev"===o&&n.reverse();const i=n.indexOf(e.currentTarget);n=d.loop?(t=i+1,(r=n).map(((e,o)=>r[(t+o)%r.length]))):n.slice(i+1);}setTimeout((()=>R(n)));}var r,t;}))})))}));const b={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function R(e){const o=document.activeElement;for(const r of e){if(r===o)return;if(r.focus(),document.activeElement!==o)return}}const Root=RovingFocusGroup;const Item=RovingFocusGroupItem;

exports.Item = Item;
exports.Root = Root;
exports.RovingFocusGroup = RovingFocusGroup;
exports.RovingFocusGroupItem = RovingFocusGroupItem;
exports.createRovingFocusGroupScope = v;
